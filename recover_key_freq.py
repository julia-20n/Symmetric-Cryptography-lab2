from collections import Counter

ALPHABET = 'абвгдежзийклмнопрстуфхцчшщъыьэюя'
ALPHABET_SIZE = 32
ALPHABET_INDEX = {ch: i for i, ch in enumerate(ALPHABET)}

def preprocess_text(text):
    return ''.join([c.lower() for c in text if c.lower() in ALPHABET])

def split_text_into_blocks(ciphertext, r):
    blocks = ['' for _ in range(r)]
    for i, char in enumerate(ciphertext):
        blocks[i % r] += char
    return blocks

def determine_key_letter_Ir(block, most_common_plain='о'):
    freqs = Counter(block)
    if not freqs:
        return 'а'
    y_star = freqs.most_common(1)[0][0]
    y_index = ALPHABET_INDEX[y_star]
    x_index = ALPHABET_INDEX[most_common_plain]
    k = (y_index - x_index) % ALPHABET_SIZE
    return ALPHABET[k]

def recover_key_Ir(ciphertext, r, common_letter='о'):
    blocks = split_text_into_blocks(ciphertext, r)
    key = ''.join(determine_key_letter_Ir(block, common_letter) for block in blocks)
    return key

def main():
    ciphertext = """
    деьооуцмдурьдыегныьпуыккэаонтцчхлуучктвдджоаубуяцбхкугбэщешряцзывтшщяшхтяяуюйлрънпрйбдшзъняъмйнуьря
пьщгтуьзразхтпфгяжитхчьурвттдфанвзгьячрщюитобущузсшзпуыхнмвбуъняэаоемйнеорцбэзмюцйхлыпейжцбышяпщчсу
щкдбкалтозьевефямнумвеаыяпцезьуотпъяуччтшкъуньдцплчжурпэнямноннщтвддщоюнгкшцкуьщщдднтютэнцьмухрчбв
щгртчпщыупшоыуфщгхнжхуучехфщвчыыэееъщахььрхобщглэччзекцьэахатггъесюекчпнрщчозьтчмуцгшъмьаьлефуьррар
ишужыэюваелунэкззфвьюррвтецэцжемпвжшралризщцоьпнвхчхньтьцъоннтдфаъняэаозжярптлйжцщшрзтоьавхтмечэумэа
гнюявстуьччцрэезшсцхзяршуъхтанвчыбгпэзчбаьбхючрлщхткгзгьумыкэецрпшьтьатьдэкякоьпклэябфугэущфщазсфвйгтьр
ъеюаноннъвыанрзбчехуцокржзввщцшсъуньтнхквеачцвуэкшоучктвдджлрззесупютпфъцщпюзчдуызиххгусннтцхцньалтй
бпяувфкдкмйнеовяпкрртуьищюрйчрчбгркртяпщсжечзцыцркртяищюрйкпьщчцдчтеопьтункфхбщрыкытуужкыбжпэрстць
цутзркйфвчвыонйуцкмущрббйллтамупцнечвзюъбтзчелрахчэжьхъэдыбдуоьупкйфюуюпъндрйтзошжьаахзефетлаххпмвеа
ыъхпчпыомуьъщюнгйшряшццфпкужувлэвццшфакзыдвсгхнаркфюыввьрадфрсхтьслщржефряасдвчкчкрнкчкщудлбшмген
ьйзъвншяудъчесюрткцзбыьщвфежхртрпбзябфрйртьжжщзюпрхмчьсткдтжъинмржанчзцнвупцпуфрцдфщдщжьхцьекковщ
чэалчувэьсхшужбапмрнюхлхпумкшааьсхоокцьдкбзеэаонеезехазхкмжбщшяхчцтруучпужхчшмшпятръркозябьлррчуцкэр
йшгбознняхецщрбчшнрэаанзшиплхвчжщжбдлйшквгпцмефофхвлютрьтуупкъзшэаргрзечшужехзюбъьйрчусрябыкжцуялж
рйксрюхткуццаынфкдкхцлжпньэантзнйкцкехпщщдьщвюдюахооууфвхтызйзтушуоцхэмуэуйютььшьртлэяътчдзейкцупчп
олеанрхиыепоикмрлшязфюхеэюмсунршжфжфюйярншвршъфиъьжютйнхьончзггччдэтезэусршогуэзсютчзлазнсрбеъхтэкъ
умйнзбзйючуцрцтзвучрпкыдчынщмчсгцкпшешуфжмшсчръутубкбанфмюлочщпэубкбыдзйрхчтпоъчшкббшюмхиежжщдь
пчвюовзъкярудрпкйфюаьывуэкмйнумщщиэрсрпбехьпзызцгччюяхцчлщзишдгбцшюваазщюрччкюбяшнбнвчръпапрлэъят
деапюбънсвюютпътевзларотмвццлррйярьнпетйцбщвзъейуъюкпкйпхтцоюйднчофбмздиапмшсирщррсэяжбхщцхрезршвтк
гясцлкюцуфщяфуйпббчумхфзкщтрртовшгэпхсвкшцзуфтзщъэыбкшдщпрршщюбыьнчйччзязжпффэгхячейбябфрйтюбдщп
локкпцпнхгпшхщжрюячущгашфцачгмшъщрунпнужщьгэбшчьрзырцьюдущппрлчрлуеущхчуэлгххэецодфшужбсшмюойх
рррипкходзлюльчпщбчшевкдщалужхлржеьюсееьбюгзумьучжуцбчщстхчюрыккфпфддщюйкгшщыдцпешузняынвфыьър
шзьеавдууднхьейкпщфнцншйзкныккййпэъхнвузарьпфъзгбцлбрршаццжрйпщцанргюдуьакчпищэтцнинямщыфнфмзчтщм
яхцчлщудшфшшыьстнйкцкпууиьъяунъебмнбщкчмфэбыдъхчцрыехпщщдьуипмтпоьдуъкябяьнбрчйхцозетфщчшзхсяплш
гамжвэттявквбьадуыдвызькюзжхузххтдчюттзяуыткрсехзкввщзчтецущвтьтвваьзьаирзядуигщюъхнтччпсуучктфюгкжрфз
дэофбмцзеэкпфрцтрсрженьтгшъвувбхьшнъмзюсыъшичмрапапужудззтпечщюэъсвггчдяыуибварттгзчохнуйчзбцтпэнугчт
яяхьюлщрцжхлшяуйрсщааьжньюбуецзжшжуьщзйпдуеъвябущзрезхккяыфхяъуатупхйжужудздчежхрзвркурвэщсбпчдцмг
умюжбпэнсавупщбтпевтгшнюфзкпункчпвътъпхюьтщцгеыффхвлжакпкшцклпкгбщнныкднуямхедфюгкгыддкоьдцпешуп
цдькдчььоттфщюошъщьйуэьпкореэттяэтекуяошьпвшьщвфещищюрйптфъврчрряйыооеьклшгхзщпзшсьмнхклыдлкмтхнц
цщеупзсдщнэфеплекзкнчбэщбюояищррхтнжызщнэубушущтшффэдщсрпщцрлфущтщэвлрэуыехомжещщцашдтапрщруд
фрчбвщгртчхюжзттбзээщмхтядщаучэсяшяуюючжхлркрщтьхапзыньищрхтепьшзщсппчмлщрцжгпэтхнхкгшпунупуяыьэн
шмйунотнгзэбблжфащецывсшнщфчшзыныуаьжнхкеюеазюпчпщчпнлхшпбынъеюкоцоткйьддщбшрязутзртмяугьмггыечб
сусжббфрцххесььцназдбюэнютеьрыюзшнббфлкбдязьуеумрдыэхяъжтьрсртпдплэщяэежкпоеунклшгхзецезравъшпггаьсю
шътраврчведфщдоуичщюрлчрееойлэнйкцкпуыфрсъьбюнгнвцучшцзеэкпэагнььржъвъшяуюьндеьезчьрчбйэнтуййррошру
юбыуехтипщченцпфъъкфьувупуибмзшшдьдсдышыырубзбпкюлшчщпцоуцкчфиьлйсадкпьършжватвяыбичновъфвюфнвд
уудкнйършклеаррыншнтрфуърчбьцябцчньшнгбкжпбрсаущелцйьпфцшвэнууьищюрзкфвфнцнсаеьрыюъштвлауцвуэкьррн
цкцъцщфрсятжаюкцуцбъчзвкгтжъкубмфяъшясрьйшьоскнщаохньряырхпепфщятцдэббучщкыпмфэеанаббещыжемкяатьб
бкмнчйхцьхгуэурсещркщкфпфдбфюзхиехщрхжкняваънткыкшцацкифюъуфяуыеыуучтдюбябдъудыщркцфнтктцзшфьчыь
детзчбвщбржтрщбпкнреевлмэуьумймтшдщаърфюйячзэрткъьяьняачяхлъсхтжщеьюцшчьрйябйпфьяаццшчяплшгшофвкд
щсюзтцчофхтдфшдънбнынэлфефовюйлцрцыхюсротхэччэьвудетйдехрепешдуужуптзхркцудзгюжзарьфтшъщаъкрвущеыц
ыецкьбйрбшйдуаьжньююатчзбныкэкгахршюсшдууйдсунутчвчъцнэпдечарржмвваэньшочщящньвядфщдочезлюкюпуюбр
щапмчтшьучжааоевзвквдмьбртуршхщзфеэкпцткффвгущюыццзщасуокжшшрмрэяшвцфкхббувщгтцьсжяндгкэцэюаюпеф
щюбйшщбоыннбфячлыпаупфееывхтьзрцыкотьачщгэебусуячшфлшэщбхььпаьжнмъььфьдуйчзхонуввйыгтнэчяпщъжкъиф
юфытъемзьменцпфъъйххртъънфткжкудзкхчыеваритобущуэткибоьтуопфлъпяьажуьбгжшффяцщлрэднаяскфффээриэккцэ
ювнмвяыущюынибхомжербачюжэевнпбчумзбддннбчьцшннуыюггъшдьпкэлаюцфрдбюшнхняиыофбммфгджоюйщрунпн
пожуьуфыгыкфшвплзяыьщбчежуьщзйчкщччьювбждэывйавжпэрсттчэръеуършшгэяыншукаюцйдешхщаюдйцкстуцмвцан
нанйбъьуахвжпбурмсчмшомуцкжпгкцшчччзшпннкхбсэрпфесщсвчжгщчяжлгьячзстецржшъняэнщешйщлпнфтйэнвуиплх
вчжмфлэкмгрдуьывькнфътхтанвчыбгпэсвцэкгхрдецбпштсвеачтцкиплхврытфдгэяэущпщчжецэеюсдзхфехктрьчэщкъэяоч
яюрттнчвьееывхтьзлювмчэйетчаюпвкфцсхшщщштннвфейвцпнхкепшрсххжкццфуьрцбдщмюньцэкгкхкюбфсзызйучфзйш
ощццрзпфзупьнлкнхжвхзэзйучфзвьвъшцндабжхщакзодщгъчъзеичщркйпньдоуючтчррсрйшофляйэцнютзцжуцвжушрзбче
хунчехвжэацорпичлрпнсвшхъсйшыьржчтдодетьуфчежхрззттлвцвлмшььтучкеямфэужцхиетррээхргбгэмюкьцэкдхпжббть
йюхесшьзтпнръсэяъпчпъьиеххэдьлегчочщпзртмвхярзбфершнзчщрееанзютьрьбжефвбуьщпюзукчъвцхзгыллмхфецэывдч
рьачцычдиплхвчжщжбужръузучывдрзбдьщияхяццбеншпбшцрпцевнтяфхкчфкдщалудкчызйэофюъптатеепутлкнгбфлпре
лешоунйужувуйррьчгуучтжщдсэзэкйхрхдунрьвацнгсдуоьмуьрдоыхнуйччщяншркяхцрмйнбеацхспнюбчхяъцйхкэвчжяжб
длуртчцучучшбябужйэущкшыршодщгъьйакичуртшфкьхгрвфешуыърчкнвчящзвуэкьсншлрюыюнжфумучъпунрзщъамлто
кыойзпнвдоьорруткбгкхкюбфлалрчслщзтжмфтдщцэуцюушмхшдфеомъыеифщщришоябшлрмцжеэкртэмдофлкбдиищщрз
шлхоэщерхбупбътшдыуьыъваьйнутныфзктцрпзьчрюдфпщюшхюгхреццйъехкепфтгюъянтшхъчкцъцщфшмвунуынпкщяе
мъыуичыоътшсвчапдпресщыгуйнетьлйсаокоьпкмэмюахяъжткоьпксвдшщлкрщчтлякофвюфншдчешхлщкцждвгнуоючесн
яатшщрхъпдычзкньитезеанлтвхесхьейкопхюррвкпруренцпфъъйалрипюезтлнщччшзсавунцжтшщжбюшнуувгпывднкаатт
зпзбуэьтширблчцалрчцэювэчвггаэзттчзьуошыхншгэбгкъууефутжжывкгюсиучыропозкчцнткбшъьпеьхдшапзэубучбгахрж
тшхнюььтзбиээоуеешябзбрляуеяевхаызыудплшгаыффгткрмуйаьшвчжрхнсьмхтядьрркцхжтшркюскьюручмхбыялцвудкъ
ьчурзьрдщсгьячрщюиъзлшгхнууцмжшввьржкчцнткбзябфрйтщяасдвкикмусхпжеетнзвбьйнопкрзбыэьюшзчтурвтещхогэп
юуъркыхрыбцдтыящниплхврвхжыдргркызлызлппьюгкйрпфчщыкцьтфаящмрмдевцннфпфяящбюиешвцфкхбьддщпшняи
рьехкцьыярйюкъухьдехзбэачзееярлявзмклуътфюъвунэтнпчфюашмхуыншоуцпужгафбрхьтзшрошпабэщгюощаььмнууаж
хцъщцъхщъвйчэаывюйрсянъьннахцыцшнзчеищррхтфхугщлшзиечьойпнщцацнбпчпухгубмьфемтсшчушохлппщяацнфец
ррафхтжкудумючелррэцшмфтгэпюодекезхчрхганяппзеьырюпмфтапмшсирщррсчзшшфухрегеыъзркжьетхяпхчммцфткбм
жюшяпзикъьзчцвябвщрбнацхцзхшофагжзеумувуфьэфркдщсрпямлщюкьууцацнбничжъуспчвязлфръчфрюдупреаанявквб
шьзмчвюбюьстуипщрврппюуюутэеифщъпгщтвыщщчыудеуъзттпфиепзакбчщювцъзшыгюпюзтъшосхйищаящръшотжгск
овчбхщбъуйуыйзнчвьячшзэайуаьждьсвбукжртдуьакзотзцфугшсдунобеютвчъэятуюхщткркурыщъдэамупцффшжхбйрмпц
уъщгрьпфгбчэоыдпкэьпеысщютьцгзичньозтажхъэплфечщъзюптвятшршкркурукяпфдавяаущецодцпчшушрахряпщрвучсв
чгркътьоуямесвядэлгъукржпвдыюауэщпюцинфямнубыоььбюкхтрфпуыфрсъъпшдйтщмйзэщббгэыотчфщъкткзжчврбэкъх
резцфкэрдщоюруцэцнупльбялрвевеыоуцфвыофлсмкгшьехзыфцбюутскынэунбчрлеанврйцььшрсэзыччюмхкьцэкчшьрдуя
лфгчехрфкзпфаующцъеячлъфефкщцвючшччпуужачкжуьудъешехцхъшчябфэъъзттлхэзкаждсхясебечцвпкгфэъгзэпчсуцде
ъбжжяуфсузюьштеыпщаохзьняцьцпкчююыюусрпеоншхцчээетхнщзбшьыэобфвввщрвуклляурэъфюъчъбркэлщкнмжджхн
рхъдеььукчкяуапмрнйесуоаынрузщпюэежжцчфшищаъэывнмуьшвмкнфяяргшхьпэьтэкопхгроюььсюарзысвяяукшьйушоъ
жпньэанмхльтлакткожшбрпмпчмлщрцжужгтшмлсочщъэйшуьибщпъебчщызмкощктцзбущкыжзтчрзвеьйррянтркйэффэей
брлдшйэрйърхааьсмзьищфкмчкюуьннюжркщырччреыдьюъльтдцпкфвюбяыдиеьчпщбцпгурдщсэеишдыэомрггаьпртуэрл
фучзьадрпхцезлщрткуцбфьдсайбчьикьопачпняшиплщкйкищыюжрыночщезршдщэьщсюхтоньдцймзсбщвюйкъщткчммф
юагяенифуасуосвюаоньселранглкжпччтфещтщбиксвебвщйркачыцжыкфрвакрэнвеьрргцэеюопзакбчщюъецпщэтсдвццуш
огасвбшхщоюэвевуеуьряпьщмхйьрлуфцйхбугноаущншдкншфеэехзбперзшртппзщящвюзюйщюпунрьрдщоючесюефуырц
дччмхйьрлуфцйфвкдщмглдушбдуьмлшююмрсщйыбефшпфчамзыуибсупньюсеаонсквнхьдефржбвщвюйчлрцдушгдущус
мтьрзхбженвщчшявагйуюзпьрдлтумбфьпэьтэккцдчшяинънчывмтщщдьудфегащфкртжфщчънеузугунньрлаангашъшнцжк
хккшэзешмднпцткффвгклаххьчназеьтщюастшцгуэюксмзщюасдбнынэрвхппрэтььвебнчрзкърадъкэйеццвоучхкцусуппйес
ьызолзяыьщбьевкшкмнууюгрвдэттоэьщтшзчбътгюскпцуыецкцодлшшрядпоазпщщгъшйгныечйфхпгзсдвсюжтдшусхпощ
аящоанърлякртгщюъхнтеязлюзтжмзбцшзьцвуньомктффаэяыегегцпешмфътцнббочщрвхппрэтшдяхеьзпэркйфяесешчукфб
гхкфффнцнэкеьрыючшдщдчцнвувбхькмчвяыйэняункцйойчбадбщпшряныбеехкепфщстегцбупетжщеьщбррьтхьсуэньйчн
ъбубнфхжуърцоындамярлрдавкжбыьнауопрехжтйгбцятаеэпуэвйкзжатцнсзейшьлхэмщвтвйрпдноржхэевьдщкбччдьбмум
вжусъяыпчмлыкстжщегррвхччщфзцфпьцтчз
    """
    r = 15
    
    cleaned = preprocess_text(ciphertext)
    key = recover_key_Ir(cleaned, r)

    print(f"Ключ, знайдений методом індексів відповідності: {key}")

if __name__ == "__main__":
    main()